</DOCUMENT>
<DOCUMENT filename="index (8).html">
<!DOCTYPE html>
<html lang="uk" class="dark some-other-class">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ANTI RUB - On-chain Dashboard (Arbitrum One)</title>
<link href="data:image/svg+xml,&lt;svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'&gt;&lt;rect width='100' height='50' fill='%230057B7'/&gt;&lt;rect y='50' width='100' height='50' fill='%23FFD700'/&gt;&lt;text x='50' y='60' font-size='50' text-anchor='middle' fill='white' font-weight='bold'&gt;₴&lt;/text&gt;&lt;/svg&gt;" rel="icon"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<link href="css/ai-support.css" rel="stylesheet"/>
<style>
body { opacity: 0; transition: opacity .2s ease; }
body.page-ready { opacity: 1; }
body:not(.page-ready) * { animation: none !important; transition: none !important; }
</style>
<style>
:root {
--primary: #4a90e2;
--secondary: #357abd;
--accent: #60a5fa;
--dark: #0f1628;
--gray: #8b94a8;
--red: #ef4444;
--card-bg: rgba(255,255,255,0.03);
/* ПРАПОР УКРАЇНИ — правильні кольори */
--ukraine-blue: #4a90e2;
--ukraine-yellow: #ffd700;
}

{ margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; }
body {
font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
background: linear-gradient(135deg, #1a1f3a 0%, #0f1628 100%);
color: #e0e6ed;
overflow-x: hidden;
line-height: 1.6;
}

.bg-animated {
position: fixed; top: 0; left: 0;
width: 100%; height: 100%;
z-index: -1;
background: linear-gradient(180deg, #4a90e2 0%, rgba(74, 144, 226, 0.2) 50%, rgba(96, 165, 250, 0.1) 100%);
opacity: 0.08;
}
.ukraine-banner { display: none; }
/* ====== NAV ====== */
nav {
position: fixed;
top: 0;
width: 100%;
padding-left: calc((100vw - 1200px) / 2 + 20px);
padding-right: calc((100vw - 1200px) / 2 + 20px);
padding-top: 20px;
padding-bottom: 20px;
display: flex;
justify-content: flex-start;
align-items: center;
z-index: 1000;
background: rgba(15,22,40,0.95);
backdrop-filter: blur(20px);
border-bottom: 1px solid rgba(255,255,255,0.1);
}
.logo {
display: flex;
align-items: center;
gap: 10px;
text-decoration: none;
cursor: pointer;
}
.logo-icon {
width: 44px; height: 44px;
background: linear-gradient(135deg, var(--ukraine-blue), var(--ukraine-yellow));
border-radius: 50%;
display: flex;
justify-content: center;
align-items: center;
color: #000;
font-size: 1.8em;
font-weight: 800;
transform: rotate(180deg);
}
.logo-text { display: flex; flex-direction: column; line-height: 1; }
.logo-text-top { font-size: 1.25em; font-weight: 700; color: var(--ukraine-blue); letter-spacing: 0.06em; }
.logo-text-bottom { font-size: 1.1em; font-weight: 700; color: var(--ukraine-yellow); letter-spacing: 0.1em; text-transform: uppercase; }
.nav-left { display: flex; align-items: center; gap: 12px; }
.main-nav {
display: flex;
align-items: center;
gap: 10px;
margin-left: 6px;
margin-right: 10px;
}
.main-nav-link {
padding: 10px 22px;
border-radius: 14px;
font-size: 0.95em;
font-weight: 600;
color: #e9eefc;
text-decoration: none;
white-space: nowrap;
transition: 0.25s ease;
border: 1px solid rgba(255,255,255,0.16);
background: radial-gradient(circle at top left, rgba(0,87,183,0.40), rgba(0,0,0,0.92));
box-shadow: 0 10px 25px rgba(0,0,0,0.7);
}
.main-nav-link:hover {
border-color: rgba(255,255,255,0.35);
background: radial-gradient(circle at top left, rgba(96,165,250,0.55), rgba(0,0,0,0.95));
box-shadow: 0 14px 32px rgba(0,0,0,0.85);
color: #ffffff;
}
.main-nav-link.active-session,
.main-nav-link.nav-link-active {
border-color: rgba(255,255,255,0.40);
background: radial-gradient(circle at top left, rgba(96,165,250,0.65), rgba(0,0,0,0.98));
box-shadow: 0 14px 32px rgba(0,0,0,0.9);
color: #ffffff;
}
.nav-right {
display: flex;
align-items: center;
gap: 10px;
margin-left: 2px;
margin-right: 8px;
}
.lang-switcher {
display: flex;
gap: 6px;
padding: 3px 6px;
border-radius: 16px;
border: 1px solid rgba(255,255,255,0.12);
background: rgba(0,0,0,0.4);
}
.lang-btn {
padding: 4px 8px;
font-size: 0.78em;
border-radius: 12px;
border: none;
background: transparent;
color: var(--gray);
cursor: pointer;
transition: all 0.3s;
}
.lang-btn.active { background: rgba(0,0,0,0.35); border: 1px solid rgba(255,255,255,0.15); }
.ua-top { font-weight: 800; font-size: 0.95em; color: #0057B7; display: block; line-height: 1; }
.ua-bottom { font-weight: 800; font-size: 0.70em; color: #FFD700; display: block; line-height: 1; margin-top: -2px; }
.en-top { font-weight: 800; font-size: 0.95em; color: #e9eefc; }
.connect-btn {
width: 175px !important;
height: 42px;
padding: 0;
font-size: 0.85em;
border-radius: 14px;
font-weight: 600;
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
border: 1px solid rgba(255,255,255,0.16);
background: radial-gradient(circle at top left, rgba(0,87,183,0.45), rgba(0,0,0,0.96));
color: #e9eefc;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: 0.2s ease;
box-shadow: 0 10px 24px rgba(0,0,0,0.7);
}
.connect-btn:hover {
border-color: rgba(255,255,255,0.35);
background: radial-gradient(circle at top left, rgba(96,165,250,0.65), rgba(0,0,0,0.98));
box-shadow: 0 14px 32px rgba(0,0,0,0.9);
color: #ffffff;
}
.connect-btn.connected {
border-color: rgba(34,197,94,0.7);
background: radial-gradient(circle at top left, rgba(34,197,94,0.55), rgba(0,0,0,0.96));
}

/* Випадаючий гаманець */
.wallet-button-area { position: relative; display: inline-block; }
.wallet-dropdown {
position: absolute;
right: 0;
top: calc(100% + 6px);
background: rgba(15, 22, 40, 0.98);
border: 1px solid rgba(255,255,255,0.12);
border-radius: 14px;
box-shadow: 0 14px 30px rgba(0,0,0,0.7);
display: none;
min-width: 180px;
padding: 6px;
z-index: 9999;
}
.wallet-dropdown.show { display: block; }
.wallet-dropdown button {
width: 100%;
padding: 10px 14px;
background: transparent;
border: none;
color: #e9eefc;
text-align: left;
cursor: pointer;
border-radius: 10px;
transition: 0.2s ease;
font-size: 0.85em;
}
.wallet-dropdown button:hover { background: rgba(255,255,255,0.05); color: #ff6b6b; }
/* ===== Модалка вибору гаманця ===== */
.wallet-modal {
position: fixed; top: 0; left: 0;
width: 100%; height: 100%;
background: rgba(0,0,0,0.95);
display: flex;
align-items: center;
justify-content: center;
z-index: 9999;
padding: 20px;
backdrop-filter: blur(10px);
}
.wallet-modal-content {
background: var(--dark);
padding: 40px;
border-radius: 20px;
max-width: 500px;
width: 100%;
max-height: 90vh;
overflow-y: auto;
overflow-x: hidden;
border: 2px solid var(--ukraine-blue);
box-shadow: 0 20px 60px rgba(0,87,183,0.4);
animation: modalFadeIn 0.3s ease-out;
box-sizing: border-box;
}
...(truncated 24599 characters)...classList.remove("show");
}, 250);
}
walletArea.addEventListener("mouseenter", () => {
if (walletConnected) showDropdown();
});
walletArea.addEventListener("mouseleave", () => hideDropdown());
disconnectBtn.addEventListener("click", () => {
if (window.disconnectWallet) window.disconnectWallet();
if (window.onWalletDisconnected) window.onWalletDisconnected();
});
const prevOnWalletConnected = window.onWalletConnected;
window.onWalletConnected = function(address, meta) {
try { prevOnWalletConnected?.(address, meta); } catch (_) {}
walletConnected = true;
connectBtn.textContent = address.slice(0,6) + "..." + address.slice(-4);
connectBtn.classList.add("connected");
};
const prevOnWalletDisconnected = window.onWalletDisconnected;
window.onWalletDisconnected = function(meta) {
try { prevOnWalletDisconnected?.(meta); } catch (_) {}
walletConnected = false;
connectBtn.textContent = "Підключити гаманець";
connectBtn.classList.remove("connected");
dropdown.classList.remove("show");
};
// ✅ ВИПРАВЛЕННЯ: при кліку викликаємо connectWallet (вона всередині сама покаже селектор гаманця)
connectBtn.addEventListener("click", async () => {
if (!walletConnected) {
if (window.connectWallet) {
await window.connectWallet();
return;
}
// запасний варіант на прямий запит
if (window.ethereum?.request) {
const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
const address = accounts?.[0];
if (address && window.onWalletConnected) window.onWalletConnected(address);
return;
}
alert("Web3-гаманець не знайдено. Відкрийте сайт у браузері MetaMask.");
}
});
</script>
<!-- Ethers -->
<!-- Провайдер WalletConnect (v1) -->
<script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
<!-- Web3Modal (v1) -->
<script src="https://cdn.jsdelivr.net/npm/web3modal@1.9.12/dist/index.js"></script>
<!-- Навігація активна -->
<script>
document.querySelectorAll('.main-nav-link').forEach(btn => {
btn.addEventListener('click', () => {
document.querySelectorAll('.main-nav-link').forEach(b => b.classList.remove('active-session'));
btn.classList.add('active-session');
});
});
</script>
<script>
// Сумісність: уніфікація id кнопок відключення на сторінках
(function(){
const btnA = document.getElementById('disconnectWalletBtn');
const btnB = document.getElementById('walletDisconnect');
if (btnA && !btnB) btnA.id = 'walletDisconnect';

const menu = document.getElementById('walletDropdown');
const menu2 = document.getElementById('walletMenu');
if (menu && !menu2) menu.id = 'walletMenu';
})();
</script>
<script type="module" src="js/app.js"></script>

<script>
let currentRate = null;
let usdRubChart = null;

const years = ['2020','2021','2022','2023','2024','2025','2026','2027','2028','2029','2030'];

function buildUsdRubDatasets(rate) {
const historyData = [72.3, 73.7, 140, 110, 92.8, rate, null, null, null, null, null];
const scenarioData = [null,null,null,null,null, rate, 200, 400, 500, 350, 250];
const currentPointData = [null,null,null,null,null, rate, null, null, null, null, null];
const peak2022 = [null,null,140,null,null,null,null,null,null,null,null];
return { historyData, scenarioData, currentPointData, peak2022 };
}

function formatShownRate(rate) {
const decimals = (window.CONFIG?.ORACLE_DECIMALS ?? 6);
if (!Number.isFinite(rate)) return '—';
return rate.toFixed(decimals).replace(/\.?0+$/, '');
}
<script>

function updateChartAndLabels(sourceLabel) {
// ВАЖЛИВО: arubPriceValue НЕ ЧІПАТИ — його оновлює app.js за oracle
const shown = formatShownRate(currentRate);

const currentRateSpan = document.getElementById('currentRateText');
if (currentRateSpan) currentRateSpan.textContent = shown;

const legendCurrentRateText = document.getElementById('legendCurrentRateText');
if (legendCurrentRateText) legendCurrentRateText.textContent = `Поточний курс (${shown})`;

const sourceEl = document.getElementById('rateSourceIndicator');
if (sourceEl) sourceEl.textContent = 'Джерело даних: ' + (sourceLabel || 'oracle');

if (usdRubChart && Number.isFinite(currentRate)) {
usdRubChart.data.datasets[0].data[5] = currentRate;
usdRubChart.data.datasets[1].data[5] = currentRate;
usdRubChart.data.datasets[2].data[5] = currentRate;
usdRubChart.data.datasets[2].label = `Поточний курс (${shown})`;
usdRubChart.update();
}
}

function initUsdRubChart() {
const ctxEl = document.getElementById('usdRubChart');
if (!ctxEl) return;

const ctx = ctxEl.getContext('2d');
const seed = Number.isFinite(currentRate) ? currentRate : 80.98; // тільки для першої отрисовки
const { historyData, scenarioData, currentPointData, peak2022 } = buildUsdRubDatasets(seed);

usdRubChart = new Chart(ctx, {
type: 'line',
data: {
labels: years,
datasets: [
{ label: 'Історичний курс', data: historyData, tension: 0.45, borderWidth: 2, borderColor: '#4ba3ff', fill: false, pointRadius: 0, pointHoverRadius: 0 },
{ label: 'Сценарій 2025–2030', data: scenarioData, tension: 0.35, borderWidth: 2, borderColor: '#4ba3ff', borderDash: [6, 4], fill: false, spanGaps: false, pointRadius: 0, pointHoverRadius: 0 },
{ label: `Поточний курс (${formatShownRate(seed)})`, data: currentPointData, borderWidth: 0, pointRadius: 6, pointHoverRadius: 8, pointBackgroundColor: '#ffd54a', pointBorderColor: '#ffd54a', pointStyle: 'circle' },
{ label: 'Пік 2022 року (140)', data: peak2022, borderWidth: 0, pointRadius: 7, pointHoverRadius: 9, pointBackgroundColor: '#ff4b4b', pointBorderColor: '#ff4b4b', pointStyle: 'circle' }
]
},
options: {
responsive: true,
plugins: {
legend: { display: false },
tooltip: {
callbacks: {
label: function (context) {
const v = context.parsed.y;
if (!v) return '';
return `${context.dataset.label}: ${v.toFixed(2)} RUB`;
}
}
}
},
scales: { y: { beginAtZero: false } }
}
});

updateChartAndLabels('oracle');
}

window.addEventListener('oraclePriceUpdated', (e) => {
const d = e?.detail || {};
if (!Number.isFinite(d.price)) return;

currentRate = d.price;
updateChartAndLabels(d.sourceLabel || 'oracle');
});

window.addEventListener('load', () => {
initUsdRubChart();
});
/script>

<script>
// Навігація: підсвічування активної кнопки при кліку та прокрутці
const navLinks = document.querySelectorAll('.main-nav a.main-nav-link');
const sections = [];

navLinks.forEach(link => {
const targetId = link.getAttribute('href');
if (targetId && targetId.startsWith('#')) {
const section = document.querySelector(targetId);
if (section) sections.push(section);
}
});

function setActiveLinkById(id) {
navLinks.forEach(link => {
const href = link.getAttribute('href');
if (href === '#' + id) link.classList.add('nav-link-active');
else link.classList.remove('nav-link-active');
});
}

navLinks.forEach(link => {
link.addEventListener('click', () => {
const href = link.getAttribute('href');
if (href && href.startsWith('#')) setActiveLinkById(href.substring(1));
});
});

const sectionObserver = new IntersectionObserver((entries) => {
entries.forEach(entry => {
if (entry.isIntersecting) {
const id = entry.target.getAttribute('id');
if (id) setActiveLinkById(id);
}
});
}, { root: null, threshold: 0.3 });

sections.forEach(section => sectionObserver.observe(section));
</script>
</body>
</html>
</DOCUMENT>
<DOCUMENT filename="contracts (8).js">
/**
* contracts.js — Контракти лише для читання (стабільні через RPC)
*
* Експортує, необхідні для app.js:
*   - initReadOnlyContracts()
*   - getArubPrice()
*   - getTotalSupplyArub()
*/
import { ethers } from 'https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.esm.min.js';
import { CONFIG } from './config.js';
import { ERC20_ABI, ORACLE_ABI } from './abis.js';
console.log('[CONTRACTS] contracts.js завантажено, збірка:', Date.now());
// -----------------------------
// Стан
// -----------------------------
let roProvider = null;
let roToken = null;
let roOracle = null;
// -----------------------------
// Допоміжники
// -----------------------------
const sleep = (ms) => new Promise((r) => setTimeout(r, ms));
async function callWithRetry(fn, tries = 3, delayMs = 350) {
let lastErr = null;
for (let i = 0; i < tries; i++) {
try {
return await fn();
} catch (e) {
lastErr = e;
await sleep(delayMs * (i + 1));
}
}
throw lastErr;
}
function assertConfig() {
const rpc = CONFIG?.NETWORK?.rpcUrls?.[0];
if (!rpc) throw new Error('CONFIG.NETWORK.rpcUrls[0] відсутній');
if (!CONFIG?.TOKEN_ADDRESS) throw new Error('CONFIG.TOKEN_ADDRESS відсутній');
if (!CONFIG?.ORACLE_ADDRESS) throw new Error('CONFIG.ORACLE_ADDRESS відсутній');
return rpc;
}
// -----------------------------
// Публічний: ініціалізація контрактів лише для читання
// -----------------------------
export function initReadOnlyContracts() {
if (roProvider && roToken && roOracle) return true;
const rpc = assertConfig();
roProvider = new ethers.providers.JsonRpcProvider(rpc);
roToken = new ethers.Contract(CONFIG.TOKEN_ADDRESS, ERC20_ABI, roProvider);
roOracle = new ethers.Contract(CONFIG.ORACLE_ADDRESS, ORACLE_ABI, roProvider);
console.log('[CONTRACTS] ініціалізовано лише для читання', {
rpc,
token: CONFIG.TOKEN_ADDRESS,
oracle: CONFIG.ORACLE_ADDRESS
});
// Опціональна подія сумісності, якщо ви покладаєтеся на неї деінде
try { window.dispatchEvent(new Event('contractsInitialized')); } catch (_) {}
return true;
}
// -----------------------------
// Необхідно для app.js: getArubPrice()
// Oracle: функція getRate() повертає (rate, updatedAt)
// Ми повертаємо ЛИШЕ "rate" як BigNumber (rate масштабовано на 1e6).
// -----------------------------
const ORACLE_PRICE_CACHE_KEY = 'arub_oracle_price_cache_v1';
// Скільки секунд вважаємо допустимими "застарілими" дані оракула.
// Під арбітраж можна поставити вище, але я б почав з 300–900 сек.
const ORACLE_STALE_AFTER_SEC = 600; // 10 хвилин
function readOracleCache() {
try {
const raw = localStorage.getItem(ORACLE_PRICE_CACHE_KEY);
if (!raw) return null;
const obj = JSON.parse(raw);
if (!obj || typeof obj !== 'object') return null;
if (!Number.isFinite(obj.price)) return null;
// updatedAtSec може бути null (якщо раніше не зберігали)
return obj;
} catch {
return null;
}
}
function writeOracleCache(payload) {
try {
localStorage.setItem(ORACLE_PRICE_CACHE_KEY, JSON.stringify(payload));
} catch {
// ігнорувати
}
}
export async function getArubPrice() {
if (!roOracle) initReadOnlyContracts();
const fetchedAtMs = Date.now();
try {
const { rate, updatedAt } = await callWithRetry(async () => {
const [rate, updatedAt] = await roOracle.getRate();
return { rate, updatedAt };
}, 3, 400);
// ВАЖЛИВО: rate/updatedAt можуть бути BigNumber (ethers v5). Приводимо updatedAt до секунд.
const updatedAtSec = updatedAt?.toNumber ? updatedAt.toNumber() : Number(updatedAt);
// Тут передбачається, що далі в проекті ви приводите rate до Number "price".
// Якщо rate вже Number — залишимо як є. Якщо BigNumber — приведіть за вашими decimals.
// УВАГА: точне перетворення залежить від того, що повертає ваш oracle.
const ORACLE_DECIMALS = Number(CONFIG?.ORACLE_DECIMALS ?? 6);
const price = Number(ethers.utils.formatUnits(rate, ORACLE_DECIMALS));
// Якщо price не кінцевий — вважаємо це помилкою читання
if (!Number.isFinite(price)) throw new Error('Oracle повернув не кінцеву ціну');
const isStale =
Number.isFinite(updatedAtSec)
? (Math.floor(fetchedAtMs / 1000) - updatedAtSec) > ORACLE_STALE_AFTER_SEC
: false;
// Зберігаємо кеш останньої успішної ціни (навіть якщо stale — це все одно "остання успішна")
writeOracleCache({
price,
updatedAtSec: Number.isFinite(updatedAtSec) ? updatedAtSec : null,
fetchedAtMs
});
return {
price,
updatedAtSec: Number.isFinite(updatedAtSec) ? updatedAtSec : null,
fetchedAtMs,
isFallback: false,
isStale
};
} catch (e) {
const cached = readOracleCache();
if (cached?.price != null) {
const cachedUpdatedAtSec = cached.updatedAtSec;
const isStale =
Number.isFinite(cachedUpdatedAtSec)
? (Math.floor(fetchedAtMs / 1000) - cachedUpdatedAtSec) > ORACLE_STALE_AFTER_SEC
: true; // якщо не знаємо updatedAt — краще вважати stale
return {
price: cached.price,
updatedAtSec: Number.isFinite(cachedUpdatedAtSec) ? cachedUpdatedAtSec : null,
fetchedAtMs,
isFallback: true,
isStale
};
}
// Якщо кешу немає — пробрасувати помилку вище
throw e;
}
}
// -----------------------------
// Необхідно для app.js: getTotalSupplyArub()
// ERC20.totalSupply()
// -----------------------------
export async function getTotalSupplyArub() {
if (!roToken) initReadOnlyContracts();
return await callWithRetry(async () => {
return await roToken.totalSupply();
}, 3, 350);
}
</DOCUMENT>
<DOCUMENT filename="config (4).js">
export const CONFIG = {
// -----------------------------
// UI
// -----------------------------
UI: {
NOTIFICATION_DURATION: 5000,
},
// -----------------------------
// Oracle
// -----------------------------
ORACLE_DECIMALS: 6, // rate = price * 1e6 (єдиний стандарт по проекту)
// -----------------------------
// Мережа
// -----------------------------
NETWORK: {
chainId: 42161,
chainIdDec: 42161,
chainIdHex: '0xA4B1',
chainName: 'Arbitrum One',
nativeCurrency: {
name: 'Ether',
symbol: 'ETH',
decimals: 18,
},
rpcUrls: ['https://arb1.arbitrum.io/rpc'],
blockExplorerUrls: ['https://arbiscan.io'],
},
// -----------------------------
// Основні адреси
// -----------------------------
USDT_ADDRESS: '0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9',
TOKEN_ADDRESS: '0x161296CD7F742220f727e1B4Ccc02cAEc71Ed2C6',
// -----------------------------
// Інші контракти
// -----------------------------
ANTIRUB_ADDRESS: '0x18D1d662371AD5732Ef996A054bd7672ab626368',
VAULT_ADDRESS: '0xE5dB8Bc105775EDa8A68B5B0aA17f91F492f102B',
PRESALE_ADDRESS: '0x44960eDa62860Fb54C143f742122619c25a129d1',
ORACLE_ADDRESS: '0xC15fFAA8D6835e3238c9B73428edb6A56cb3AF89',
TX_CONFIRMATIONS: 1,
};
</DOCUMENT>
